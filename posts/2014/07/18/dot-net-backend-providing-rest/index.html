<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    
    <link rel="canonical" href="https://draptik.github.io/posts/2014/07/18/dot-net-backend-providing-rest/">
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.80.0" />

    
    
    

<title>.NET backend providing REST • draptik</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=".NET backend providing REST"/>
<meta name="twitter:description" content="TL;DR My AngularJS demo app has a new backend implementation using .NET Web API.
&hellip; Recap Our goals:
 server side: minimal working REST API providing  GET dummy CRUD users   client side (angular): communicate with server side  Setup Creating a Web API project is straightforward: Just follow the instructions at"/>

<meta property="og:title" content=".NET backend providing REST" />
<meta property="og:description" content="TL;DR My AngularJS demo app has a new backend implementation using .NET Web API.
&hellip; Recap Our goals:
 server side: minimal working REST API providing  GET dummy CRUD users   client side (angular): communicate with server side  Setup Creating a Web API project is straightforward: Just follow the instructions at" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://draptik.github.io/posts/2014/07/18/dot-net-backend-providing-rest/" />
<meta property="article:published_time" content="2014-07-18T18:46:33+00:00" />
<meta property="article:modified_time" content="2014-07-18T18:46:33+00:00" /><meta property="og:site_name" content="draptik title" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css" integrity="sha256-cRV&#43;doxOERojw1MbleDLtZu&#43;88nmkB02JHy1PWtr4lg=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://draptik.github.io/">
        
          draptik
        
        </a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://draptik.github.io/images/ant.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         mostly tech stuff 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">draptik</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/talks/">
						<span>Talks</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/impressum/">
						<span>Impressum</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	
	
	
	<a href="https://github.com/draptik" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/patrick-drechsler-985a2911" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	<a href="mailto:blog@pdrechsler.de" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>.NET backend providing REST</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jul 18, 2014
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/angularjs">ANGULARJS</a>
              •
          
              <a class="badge badge-category" href="/categories/asp.net">ASP.NET</a>
              •
          
              <a class="badge badge-category" href="/categories/c">C#</a>
              •
          
              <a class="badge badge-category" href="/categories/cors">CORS</a>
              •
          
              <a class="badge badge-category" href="/categories/ioc">IOC</a>
              •
          
              <a class="badge badge-category" href="/categories/javascript">JAVASCRIPT</a>
              •
          
              <a class="badge badge-category" href="/categories/nodejs">NODEJS</a>
              •
          
              <a class="badge badge-category" href="/categories/restful">RESTFUL</a>
              •
          
              <a class="badge badge-category" href="/categories/web-api">WEB API</a>
              •
          
              <a class="badge badge-category" href="/categories/web-service">WEB SERVICE</a>
              
          
      
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 6 min read
</div>


  </header>
  
  
  <div class="post">
    <h2 id="tldr">TL;DR</h2>
<p>My <a href="https://github.com/draptik/angulardemorestful">AngularJS demo app</a> has a new backend implementation using <a href="http://www.asp.net/web-api">.NET Web API</a>.</p>
<h1 id="heading">&hellip;</h1>
<h2 id="recap">Recap</h2>
<p>Our goals:</p>
<ul>
<li>server side: minimal working REST API providing
<ul>
<li>GET <code>dummy</code></li>
<li>CRUD <code>users</code></li>
</ul>
</li>
<li>client side (angular): communicate with server side</li>
</ul>
<h2 id="setup">Setup</h2>
<p>Creating a Web API project is straightforward: Just follow the instructions at</p>
<ul>
<li><a href="http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api">Getting Started with ASP.NET Web API 2</a></li>
<li><a href="http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api">Enabling Cross-Origin Requests in ASP.NET Web API</a></li>
<li><a href="http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver">Dependency Injection for Web API Controllers</a></li>
</ul>
<p>The final project structure will look like this:</p>
<p><img src="/images/posts/dotnet/dotnet-project-structure.PNG" alt="img"></p>
<h2 id="adding-models">Adding Models</h2>
<p>Create two new POCOs for <code>User</code> and <code>Dummy</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">namespace</span> WebService.Models
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dummy</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Id { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">namespace</span> WebService.Models
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> Id { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> LastName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
    }
}
</code></pre></div><h2 id="adding-service-layer">Adding Service Layer</h2>
<p>Create a new folder <code>Service</code> and add a <code>UserService</code> with corresponding interface <code>IUserService</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Collections.Generic;
<span style="color:#66d9ef">using</span> WebService.Models;

<span style="color:#66d9ef">namespace</span> WebService.Service
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> IUserService
    {
        ICollection&lt;User&gt; GetAllUsers();
        User GetById(<span style="color:#66d9ef">int</span> userId);
        User UpdateUser(User user);
        User CreateNewUser(User user);
        <span style="color:#66d9ef">void</span> RemoveUserById(<span style="color:#66d9ef">int</span> userId);
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Collections.Generic;
<span style="color:#66d9ef">using</span> System.Collections.ObjectModel;
<span style="color:#66d9ef">using</span> System.Linq;
<span style="color:#66d9ef">using</span> WebService.Models;

<span style="color:#66d9ef">namespace</span> WebService.Service
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> : IUserService
    {
        <span style="color:#66d9ef">public</span> UserService()
        {
            <span style="color:#66d9ef">this</span>.Users = <span style="color:#66d9ef">new</span> Collection&lt;User&gt;();
            <span style="color:#66d9ef">this</span>.CreateUsers();
        }

        <span style="color:#66d9ef">private</span> ICollection&lt;User&gt; Users { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }

        <span style="color:#66d9ef">public</span> ICollection&lt;User&gt; GetAllUsers()
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.Users;
        }

        <span style="color:#66d9ef">public</span> User GetById(<span style="color:#66d9ef">int</span> userId)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.Users.SingleOrDefault(x =&gt; x.Id.Equals(userId));
        }

        <span style="color:#66d9ef">public</span> User UpdateUser(User user)
        {
            <span style="color:#66d9ef">var</span> u = <span style="color:#66d9ef">this</span>.Users.SingleOrDefault(x =&gt; x.Id.Equals(user.Id));
            <span style="color:#66d9ef">if</span> (u != <span style="color:#66d9ef">null</span>) {
                u.FirstName = user.FirstName;
                u.LastName = user.LastName;
            }
            <span style="color:#66d9ef">return</span> u;
        }

        <span style="color:#66d9ef">public</span> User CreateNewUser(User user)
        {
            <span style="color:#66d9ef">var</span> newUser = <span style="color:#66d9ef">new</span> User
            {
                Id = <span style="color:#66d9ef">this</span>.Users.Max(x =&gt; x.Id) + <span style="color:#ae81ff">1</span>,
                FirstName = user.FirstName,
                LastName = user.LastName
            };

            <span style="color:#66d9ef">this</span>.Users.Add(newUser);

            <span style="color:#66d9ef">return</span> newUser;
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> RemoveUserById(<span style="color:#66d9ef">int</span> userId)
        {
            <span style="color:#66d9ef">this</span>.Users.Remove(<span style="color:#66d9ef">this</span>.Users.SingleOrDefault(x =&gt; x.Id.Equals(userId)));
        }

        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> CreateUsers()
        {
            <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> numberOfUsers = <span style="color:#ae81ff">10</span>;
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> id = <span style="color:#ae81ff">1</span>; id &lt;= numberOfUsers; id++) {
                <span style="color:#66d9ef">this</span>.Users.Add(<span style="color:#66d9ef">new</span> User {Id = id, FirstName = <span style="color:#e6db74">&#34;Foo&#34;</span> + id, LastName = <span style="color:#e6db74">&#34;Bar&#34;</span> + id});
            }
        }
    }
}
</code></pre></div><p>Note: This is just a quick and dirty setup to get a working REST API without much overhead. In a real application the service will probably be a bit more fine grained. For example: In this demo app the users are simply stored in memory and not persisted to a database.</p>
<h2 id="adding-ioc-for-web-api">Adding IoC for Web API</h2>
<p>Add inversion of control (IoC) to Web API:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System;
<span style="color:#66d9ef">using</span> System.Collections.Generic;
<span style="color:#66d9ef">using</span> System.Web.Http.Dependencies;
<span style="color:#66d9ef">using</span> Microsoft.Practices.Unity;

<span style="color:#66d9ef">namespace</span> WebService.IoC
{
    <span style="color:#75715e">/// &lt;summary&gt;
</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver
</span><span style="color:#75715e"></span>    <span style="color:#75715e">/// &lt;/summary&gt;
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnityResolver</span> : IDependencyResolver
    {
        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> IUnityContainer container;

        <span style="color:#66d9ef">public</span> UnityResolver(IUnityContainer container)
        {
            <span style="color:#66d9ef">if</span> (container == <span style="color:#66d9ef">null</span>) {
                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> ArgumentNullException(<span style="color:#e6db74">&#34;container&#34;</span>);
            }
            <span style="color:#66d9ef">this</span>.container = container;
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Dispose()
        {
            <span style="color:#66d9ef">this</span>.container.Dispose();
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">object</span> GetService(Type serviceType)
        {
            <span style="color:#66d9ef">try</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.container.Resolve(serviceType);
            }
            <span style="color:#66d9ef">catch</span> (ResolutionFailedException) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
            }
        }

        <span style="color:#66d9ef">public</span> IEnumerable&lt;<span style="color:#66d9ef">object</span>&gt; GetServices(Type serviceType)
        {
            <span style="color:#66d9ef">try</span> {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.container.ResolveAll(serviceType);
            }
            <span style="color:#66d9ef">catch</span> (ResolutionFailedException) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> List&lt;<span style="color:#66d9ef">object</span>&gt;();
            }
        }

        <span style="color:#66d9ef">public</span> IDependencyScope BeginScope()
        {
            <span style="color:#66d9ef">var</span> child = <span style="color:#66d9ef">this</span>.container.CreateChildContainer();
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> UnityResolver(child);
        }
    }
}
</code></pre></div><h2 id="adding-controllers">Adding Controllers</h2>
<p>Create controllers <code>UsersController</code> and <code>DummyController</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Web.Http;
<span style="color:#66d9ef">using</span> System.Web.Http.Cors;
<span style="color:#66d9ef">using</span> WebService.Models;

<span style="color:#66d9ef">namespace</span> WebService.Controllers
{
<span style="color:#a6e22e">    [EnableCors(origins: &#34;http://localhost:9000&#34;, headers: &#34;*&#34;, methods: &#34;*&#34;)]</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DummyController</span> : ApiController
    {
        <span style="color:#66d9ef">public</span> Dummy Get()
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Dummy
            {
                Id = <span style="color:#ae81ff">0</span>, 
                FirstName = <span style="color:#e6db74">&#34;JonFromREST&#34;</span>, 
                LastName = <span style="color:#e6db74">&#34;Doe&#34;</span>
            };
        }
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Collections.Generic;
<span style="color:#66d9ef">using</span> System.Web.Http;
<span style="color:#66d9ef">using</span> System.Web.Http.Cors;
<span style="color:#66d9ef">using</span> WebService.Models;
<span style="color:#66d9ef">using</span> WebService.Service;

<span style="color:#66d9ef">namespace</span> WebService.Controllers
{
<span style="color:#a6e22e">    [EnableCors(origins: &#34;http://localhost:9000&#34;, headers: &#34;*&#34;, methods: &#34;*&#34;)]</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UsersController</span> : ApiController
    {
        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> IUserService userService;

        <span style="color:#66d9ef">public</span> UsersController(IUserService userService)
        {
            <span style="color:#66d9ef">this</span>.userService = userService;
        }

        <span style="color:#66d9ef">public</span> ICollection&lt;User&gt; Get()
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.userService.GetAllUsers();
        }

        <span style="color:#66d9ef">public</span> User Get(<span style="color:#66d9ef">int</span> id)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.userService.GetById(id);
        }

        <span style="color:#66d9ef">public</span> User Put(User user)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.userService.UpdateUser(user);
        }

        <span style="color:#66d9ef">public</span> User Post(User user)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.userService.CreateNewUser(user);
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Delete(<span style="color:#66d9ef">int</span> id)
        {
            <span style="color:#66d9ef">this</span>.userService.RemoveUserById(id);
        }
    }
}
</code></pre></div><h3 id="putting-the-pieces-together">Putting the pieces together</h3>
<p>Within <code>WebApiConfig.cs</code>:</p>
<ul>
<li>configure the IoC container</li>
<li>activate CORS</li>
<li>return JSON</li>
<li>configure routes</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Net.Http.Headers;
<span style="color:#66d9ef">using</span> System.Web.Http;
<span style="color:#66d9ef">using</span> Microsoft.Practices.Unity;
<span style="color:#66d9ef">using</span> WebService.IoC;
<span style="color:#66d9ef">using</span> WebService.Service;

<span style="color:#66d9ef">namespace</span> WebService
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebApiConfig</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Register(HttpConfiguration config)
        {
            <span style="color:#75715e">// IoC container
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">var</span> container = <span style="color:#66d9ef">new</span> UnityContainer();
            <span style="color:#75715e">// Note: for this demo we want the user service to be a singleton (&#39;ContainerControlledLifetimeManager&#39; in Unity syntax)
</span><span style="color:#75715e"></span>            container.RegisterType&lt;IUserService, UserService&gt;(<span style="color:#66d9ef">new</span> ContainerControlledLifetimeManager());
            config.DependencyResolver = <span style="color:#66d9ef">new</span> UnityResolver(container);

            <span style="color:#75715e">// Web API configuration and services
</span><span style="color:#75715e"></span>
            config.EnableCors();

            <span style="color:#75715e">// Return JSON instead of XML http://stackoverflow.com/a/13277616/1062607
</span><span style="color:#75715e"></span>            config.Formatters.JsonFormatter.SupportedMediaTypes.Add(<span style="color:#66d9ef">new</span> MediaTypeHeaderValue(<span style="color:#e6db74">&#34;text/html&#34;</span>));

            <span style="color:#75715e">// Web API routes
</span><span style="color:#75715e"></span>            config.MapHttpAttributeRoutes();

            <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">string</span> baseUrl = <span style="color:#e6db74">&#34;ngdemo/web&#34;</span>;

            config.Routes.MapHttpRoute(
                name: <span style="color:#e6db74">&#34;DefaultApi&#34;</span>,
                routeTemplate: baseUrl + <span style="color:#e6db74">&#34;/{controller}/{id}&#34;</span>,
                defaults: <span style="color:#66d9ef">new</span> { id = RouteParameter.Optional }
            );
        }
    }
}
</code></pre></div><h2 id="returning-lower-case-json-from-net-web-api">Returning Lower Case JSON from .NET Web API</h2>
<p>C# uses upper case property names by default. JavaScript uses lower case property names by default.</p>
<p>To automatically convert between both worlds you can add a <code>ContractResolver</code> to your <code>Global.asax.cs</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Web;
<span style="color:#66d9ef">using</span> System.Web.Http;
<span style="color:#66d9ef">using</span> Newtonsoft.Json.Serialization;

<span style="color:#66d9ef">namespace</span> WebService
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebApiApplication</span> : HttpApplication
    {
        <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> Application_Start()
        {
            GlobalConfiguration.Configure(WebApiConfig.Register);

            <span style="color:#75715e">// lower case property names in serialized JSON: http://stackoverflow.com/a/22130487/1062607
</span><span style="color:#75715e"></span>            GlobalConfiguration.Configuration
                .Formatters
                .JsonFormatter
                .SerializerSettings
                .ContractResolver = <span style="color:#66d9ef">new</span> CamelCasePropertyNamesContractResolver();
        }
    }
}
</code></pre></div><h2 id="done">Done?</h2>
<p>Almost: For the ASP.NET backend to be reachable by the same URL as the other backends (<a href="http://draptik.github.io/blog/2013/10/01/node-dot-js-backend-providing-rest/">NodeJs backend</a> and <a href="http://draptik.github.io/blog/2013/07/13/angularjs-example-using-a-java-restful-web-service/">Java backend</a>) we have to change the default port of the application to 8080:</p>
<p><img src="/images/posts/dotnet/dotnet-project-url.PNG" alt="img"></p>
<p>Now we can start the Web API backend from Visual Studio (F5).</p>
<p>In the newly openend browser, check the URL <a href="http:localhost:8080/nodedemo/web/dummy/">http:localhost:8080/nodedemo/web/dummy/</a>. The dummy JSON object should be visible:</p>
<p><img src="/images/posts/dotnet/dotnet-project-browser00.PNG" alt="img"></p>
<h2 id="check-the-api">Check the API</h2>
<h3 id="start-the-backend">Start the backend</h3>
<p>Start the Web API backend from Visual Studio.</p>
<h3 id="start-the-frontend">Start the frontend</h3>
<p>Note: For setting up the frontend, you will need to install <a href="http://nodejs.org/">NodeJS</a> and <a href="http://gruntjs.com/">Grunt</a>. Please have a look at the <a href="https://github.com/draptik/angulardemorestful/blob/master/frontend/README.md">README.md file in the frontend folder</a> for further details.</p>
<p>Open a command prompt and navigate to the <code>frontend</code> folder.</p>
<p>Run <code>grunt server</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">&gt;grunt server
Running <span style="color:#e6db74">&#34;server&#34;</span> task

Running <span style="color:#e6db74">&#34;clean:server&#34;</span> <span style="color:#f92672">(</span>clean<span style="color:#f92672">)</span> task
Cleaning .tmp...OK

Running <span style="color:#e6db74">&#34;concurrent:server&#34;</span> <span style="color:#f92672">(</span>concurrent<span style="color:#f92672">)</span> task

Running <span style="color:#e6db74">&#34;coffee:dist&#34;</span> <span style="color:#f92672">(</span>coffee<span style="color:#f92672">)</span> task

Done, without errors.

Running <span style="color:#e6db74">&#34;copy:styles&#34;</span> <span style="color:#f92672">(</span>copy<span style="color:#f92672">)</span> task


Done, without errors.

Running <span style="color:#e6db74">&#34;compass:server&#34;</span> <span style="color:#f92672">(</span>compass<span style="color:#f92672">)</span> task
directory .tmp/styles/
       create .tmp/styles/main.css <span style="color:#f92672">(</span>1.718s<span style="color:#f92672">)</span>
    Compilation took 1.802s

Done, without errors.

Running <span style="color:#e6db74">&#34;autoprefixer:dist&#34;</span> <span style="color:#f92672">(</span>autoprefixer<span style="color:#f92672">)</span> task
File <span style="color:#e6db74">&#34;.tmp/styles/main.css&#34;</span> created.

Running <span style="color:#e6db74">&#34;connect:livereload&#34;</span> <span style="color:#f92672">(</span>connect<span style="color:#f92672">)</span> task
Started connect web server on localhost:9000.

Running <span style="color:#e6db74">&#34;open:server&#34;</span> <span style="color:#f92672">(</span>open<span style="color:#f92672">)</span> task

Running <span style="color:#e6db74">&#34;watch&#34;</span> task
Waiting...
</code></pre></div><p>Visit URL <a href="http://localhost:9000/#/dummy">http://localhost:9000/#/dummy</a>:</p>
<p><img src="/images/posts/dotnet/dotnet-project-browser01.PNG" alt="img"></p>
<p>That&rsquo;s it.</p>
<h2 id="source-code-for-this-post">Source code for this post</h2>
<p>You can clone a copy of this project here: <a href="https://github.com/draptik/angulardemorestful">https://github.com/draptik/angulardemorestful</a>.</p>
<p>To checkout the correct version for this demo, use the following code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git clone git@github.com:draptik/angulardemorestful.git
cd angulardemorestful
git checkout -f step7-aspnet-webapi-backend
</code></pre></div><p>In case you are not using git you can also download the project as ZIP or tar.gz file here: <a href="https://github.com/draptik/angulardemorestful/releases/tag/step7-aspnet-webapi-backend">https://github.com/draptik/angulardemorestful/releases/tag/step7-aspnet-webapi-backend</a></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/2014/04/21/link-collection-number-4/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">link collection #4</span>
    </a>
    
    
    <a href="/posts/2015/07/10/remotly-measuring-temperatures-with-a-raspberry-pi-using-radio-frequency-modules-from-ciseco-part-1-hardware/" class="navigation-next">
      <span class="navigation-tittle">Remotly measuring temperatures with a Raspberry Pi using radio frequency modules from Ciseco (Part 1: Hardware)</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <div id="disqus_thread"></div>
<script type="text/javascript">
    

    (function () {
    if (location.hostname === "localhost" ||
      location.hostname === "127.0.0.1" ||
      location.hostname === "") {
      return;
    }
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    var disqus_shortname = 'draptik';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || 
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<noscript>
  Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
  <span class="logo-disqus">Disqus</span>
</a>

    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-65991503-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" integrity="sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/fsharp.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/java.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/bash.min.js"></script>
            
        
    <script type="text/javascript">
        
        hljs.configure({languages: ["fsharp, java, bash"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
